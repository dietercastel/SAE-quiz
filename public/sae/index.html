<!DOCTYPE html>
<html ng-app="quiz" ng-csp="">
<!-- <html ng&#45;app="quiz"> -->
<head>
<!-- Include angular -->
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0/angular.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0/angular-route.js"></script>
<!-- Angular stylesheet inclusion needed when enabling CSP!!-->
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0/angular-csp.css">

<!-- Include bootstrap-->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

<script src="/sae/javascripts/controller.js"></script>

<style>
.evilstyle{
		evil: true;
		visibility: hidden;
}
</style>
<title>Sec-Angular-Express-QUIZ</title>
</head>
<body>
<center>
<div class="navbar">
		<div class="navbar-inner">
				<nav class="navbar navbar-default" role="navigation">
						<div class="container-fluid">
								<header>
										<h1>Sec-Angular-Express-QUIZ</h1>
										<ul class="nav navbar-nav">
												<li><a href="#">Home</a></li>
												<li><a href="#login">Login</a></li>
												<li><a href="#register">Register</a></li>
												<li><a href="#highscores">Highscores</a></li>
										</ul>
								</header>
						</div>
				</nav>
		</div>
</div>
<br>

<!-- These should be disallowed by CSP -->
<img>
<link rel="import" href='https://i.imgur.com/T3Ow1u0.gif'>
</img>
<img>
<link rel="import" href='https://www.kuleuven.be/kuleuven/images/logo-associatie-new.png/image_preview'>
</img>
<span class="ng-include:'http://www.kuleuven.be/kuleuven/images/logo-associatie-new.png/image_preview'"></span>
<script>
alert("CSP SHOULD BLOCK ME");
</script>

<!-- EXPLOITS: -->
<!-- from mustache security -->
<!-- Working CSP circumvention of non exectuting inline javascript-->
<!-- Works even with .html extension -->
<!-- <span class="ng&#45;include:'sae/test.gif'"></span> -->
<!-- <img ng&#45;src="sae/test.gif"> -->

<!-- mitigated in 1.3 -->
<!-- {{toString.constructor.prototype.toString=toString.constructor.prototype.call; ["a","alert(1)"].sort(toString.constructor)}} -->

<div id="main">
		<div id="viewbody" ng-view></div>
</div>
</center>

</body>
</html>
